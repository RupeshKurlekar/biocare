{% include 'header.html' %}
    <body class="hold-transition light-skin sidebar-mini theme-primary">
	    <div class="wrapper">
        {% include 'navbar.html' %}
            {% include 'sidebar.html' %}
                <!-- Content Wrapper. Contains page content -->
                <div class="content-wrapper">
            	    <div class="container-full">
                        <!-- Content Header (Page header) -->
                        <div class="content-header">
                            <div class="d-flex align-items-center">
                                <div class="mr-auto">
                                    <div class="d-inline-block align-items-center">
                                        <nav>
                                            <ol class="breadcrumb">
                                                <li class="breadcrumb-item">
                                                    <a href="index.php">
                                                        <i class="mdi mdi-home-outline"></i>
                                                    </a>
                                                </li>
                                                <li class="breadcrumb-item" aria-current="page">
                                                    <a href="reports.php">
                                                        Reports
                                                    </a>
                                                </li>
                                                <li class="breadcrumb-item active" aria-current="page">
                                                    <a href="javascript:void(0);">
                                                        Upload Scan Copy
                                                    </a>
                                                </li>
                                            </ol>
                                        </nav>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <!-- Main content -->
                        <section class="content">
                            <div class="row">

                                <div class="col-12">
                                    <div class="box">
                                        <div class="box-header with-border flexbox">
                                            <h3 class="box-title">
                                                Upload Scan Copy
                                            </h3>
                                            <div class="text-right flex-grow">
                                                <a href="reports.php">
                                                    <button type="button" class="btn btn-dark">Back</button>
                                                </a>
                                            </div>
                                        </div>
                                        <!-- /.box-header -->
                                        <div class="box-body">
                                           <!--  <form action="#" class="dropzone">
                                                <div class="row">
                                                    <div class="col-md-12 col-lg-12">
                                                        <div class="fallback">
                                                            <input name="file" type="file" id="dropFile" multiple />
                                                        </div>
                                                    </div>
                                                </div>
                                            </form> -->
                                            <form action="" method="post">
                                                <div class="row">
                                                    <!-- <div class="col-md-12 col-lg-12">
                                                        <div class="form_group row text-left" id="upload-files">
                                                            
                                                        </div>
                                                    </div> -->
                                                    <div class="col-md-6 col-lg-6">
                                                        <div class="form-group row">
                                                            <label class="col-lg-3 col-md-3">Report ID: </label>
                                                            <label class="font-weight-bold col-lg-9 col-md-9">#RPT_3</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6 col-lg-6">
                                                        <div class="form-group row">
                                                            <label class="col-lg-3 col-md-3">Report Date: </label>
                                                            <label class="font-weight-bold col-lg-9 col-md-9">04th Apr 2021</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-5 col-lg-5">
                                                        <div class="form-group">
                                                            <label>Patient <small class="text-danger">*</small></label>
                                                            <select class="form-control select2" style="width: 100%;" >
                                                                <option value="">Select</option>
                                                                <option value="1">Pawan Kumar (9876543210)</option>
                                                                <option value="2">Kiran Shah (9988776655)</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-1 col-lg-1" >
                                                        <span data-toggle="modal" data-target="#addModal" >
                                                            <i class="fa fa-plus-circle ml-20 mt-40" data-toggle="tooltip" data-original-title="Add Patient"></i>
                                                        </span>
                                                    </div>
                                                    <div class="col-md-6 col-lg-6">
                                                        <div class="form-group">
                                                            <label>Priority <small class="text-danger">*</small></label>
                                                            <select class="form-control select2" style="width: 100%;" >
                                                                <option value="">Select</option>
                                                                <option value="1">Very High</option>
                                                                <option value="2">High</option>
                                                                <option value="3">Medium</option>
                                                                <option value="4">Low</option>
                                                                <option value="5">Very Low</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12 col-lg-12">
                                                        <div class="callout callout-info">
                                                            <h4><i class="icon fa fa-info-circle"></i> Note:</h4>
                                                            <ul>
                                                                <li>Only .png, .jpg, jpeg files are acceptable.</li>
                                                                <li>File size must be 10MB or less</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12 col-lg-12">
                                                        <div class="form-group row" id="upload-files">
                                                            <div class="col-md-4 col-lg-4">
                                                                <div class="form-group">
                                                                    <label>Report Document: <small class="text-danger">*</small></label>
                                                                    <input type="file" name="file" class="form-control" >
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3 col-lg-3" >
                                                                <label>Body Part: <small class="text-danger">*</small></label>
                                                                <select class="form-control select2 body_part" style="width: 100%;" >
                                                                    <option value="">Select Body Part</option>
                                                                    <option value="1">Kub</option>
                                                                    <option value="2">Left Chest</option>
                                                                    <option value="3">Right Chest</option>
                                                                    <option value="4">Cervical Spine</option>
                                                                    <option value="5">Dorsal Spine</option>
                                                                    <option value="6">Lumbar Spine</option>
                                                                    <option value="7">Dorsal-Lumbar Spine</option>
                                                                    <option value="8">Adenoids</option>
                                                                </select>
                                                            </div>
                                                            <div class="col-md-4 col-lg-4" >
                                                                <label>View: <small class="text-danger">*</small></label>
                                                                <select class="form-control select2 body_view" name="view[]" data-placeholder="Select View" multiple="multiple" style="width: 100%;" >
                                                                    <option value="">Select View</option>
                                                                    <option value="1">PA</option>
                                                                    <option value="2">LATERAL</option>
                                                                    <option value="3">AP OBLIQUE</option>
                                                                    <option value="4">PA OBLIQUE</option>
                                                                </select>
                                                            </div>
                                                            <div class="col-md-1 col-lg-1" >
                                                                <span class="add_file">
                                                                    <i class="fa fa-plus-circle ml-20 mt-40" data-toggle="tooltip" data-original-title="Add File"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-12 col-lg-12">
                                                        <label>Remark: </label>
                                                        <textarea rows="5" class="form-control" placeholder=""></textarea>
                                                    </div>
                                                    <div class="col-md-12 col-lg-12 text-right">
                                                        <button type="submit" name="submit" class="btn btn-success submit_report">Submit</button>
                                                        <a href="reports.php">
                                                            <button type="button" class="btn btn-dark">Back</button>
                                                        </a>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                        <!-- /.box-body -->
                                        <!-- <div class="box-footer text-right">
                                            <button type="submit" name="submit" class="btn btn-success">Submit</button>
                                            <a href="reports.php">
                                                <button type="button" class="btn btn-dark">Back</button>
                                            </a>
                                        </div> -->
                                        <!-- /.box-footer -->
                                    </div>
                                    <!-- /.box -->
                                    </form>
                                </div>

                                <!-- /.col -->
                            </div>
                            <!-- /.row -->
                        </section>
                        <!-- /.content -->

                        <div id="addModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <form action="" method="POST" >
                                        <div class="modal-header">
                                            <h4 class="modal-title" id="myModalLabel">Add Patient</h4>
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                        </div>
                                        <div class="modal-body">
                                            <div class="row">
                                                <div class="col-md-12 col-lg-12">
                                                    <div class="form-group">
                                                        <label>Name <small class="text-danger">*</small></label>
                                                        <input type="text" class="form-control" placeholder="Patient Name">
                                                    </div>
                                                </div>
                                                <div class="col-md-6 col-lg-6">
                                                    <div class="form-group">
                                                        <label>Gender <small class="text-danger">*</small></label>
                                                        <select class="form-control select2" style="width: 100%;" >
                                                            <option value="">Select</option>
                                                            <option value="male">Male</option>
                                                            <option value="female">Female</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-6 col-lg-6">
                                                    <div class="form-group">
                                                        <label>Age <small class="text-danger">*</small></label>
                                                        <input type="text" class="form-control" placeholder="Patient Age">
                                                    </div>
                                                </div>
                                                <div class="col-md-12 col-lg-12">
                                                    <div class="form-group">
                                                        <label>Phone Number <small class="text-danger">*</small></label>
                                                        <input type="text" class="form-control" placeholder="Patient Phone Number">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer text-right" style="width: 100%;">
                                            <button type="button" class="btn btn-danger text-left" data-dismiss="modal">Close</button>
                                            <button type="submit" name="submit" class="btn btn-success text-left">Submit</button>
                                        </div>
                                    </form>
                                </div>
                                <!-- /.modal-content -->
                            </div>
                            <!-- /.modal-dialog -->
                        </div>
                        <!-- /.modal -->

                        <div class="modal fade" id="send_report_modal" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <form action="" method="post">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="exampleModalLabel">Assign Radiologist</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            <label class="mb-0" for="assign_to">Assign To Radiologist<small class="text-danger">*</small></label>
                                            <select class="form-control" name="assign_to" id="assign_to">
                                                <option value="">Select</option>
                                                <option value="1" >Dr. Ketan Sanghvi</option>
                                                <option value="2" >Dr. Tejas Sharma</option>
                                            </select>
                                        </div>
                                        <div class="modal-footer text-right" style="width: 100%;">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                            <button type="submit" class="btn btn-primary" onclick="sendReport(event);">Assign</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

            	    </div>
                </div>
                 <!-- /.content-wrapper -->
            {% include 'footer.html' %}

             <!-- Control Sidebar -->
            
             <!-- /.control-sidebar -->

             <!-- Add the sidebar's background. This div must be placed immediately after the control sidebar -->
            <div class="control-sidebar-bg"></div>
  
        </div>
        <!-- ./wrapper -->	 

        <script>

            // function add_report_file() {

            //     // setTimeout(function(){

            //         // console.log($('.dropzone .dz-preview:last-child').hasClass('dz-complete'));

            //         if($('.dropzone .dz-preview:last-child').hasClass('dz-complete')===true)
            //         {
            //             var fileNameTxt = $('.dropzone .dz-preview:last-child .dz-filename span').text()

            //             // console.log($('.dropzone .dz-preview:last-child .dz-filename span').text());
                        
            //             $('#upload-files').append('<div class="col-md-4 col-lg-4"><div class="form-group"><label>Report Documents: <small class="text-danger">*</small></label><input type="file" name="file" class="form-control" multiple="multiple" ></div></div><div class="col-md-4 col-lg-4" ><select class="form-control select2 body_part" style="width: 100%;" ><option value="">Select Body Part</option><option value="1">Kub</option><option value="2">Left Chest</option><option value="3">Right Chest</option><option value="4">Cervical Spine</option><option value="5">Dorsal Spine</option><option value="6">Lumbar Spine</option><option value="7">Dorsal-Lumbar Spine</option><option value="8">Adenoids</option></select></div><div class="col-md-4 col-lg-4" ><select class="form-control select2 body_view" name="view[]" data-placeholder="Select View" multiple="multiple" style="width: 100%;" ><option value="">Select View</option><option value="1">PA</option><option value="2">LATERAL</option><option value="3">AP OBLIQUE</option><option value="4">PA OBLIQUE</option></select></div>');

            //             $('.body_part').select2().trigger('change');
            //             $('.body_view').select2().trigger('change');

            //             return false;
            //         }

            //     // }, 2000);

            // }

            // $(document).ready(function(){

            //   var $report_file = $('.dropzone');
            //   $report_file.bind("DOMSubtreeModified", add_report_file);

            //   // console.log('test');

            // });

            $(document).ready(function(){

                var ctr=1;
                $('.add_file').on('click', function(){

                    $('#upload-files').append('<div class="col-md-4 col-lg-4 rep'+ctr+'"><div class="form-group"><label>Report Document: <small class="text-danger">*</small></label><input type="file" name="file" class="form-control" ></div></div><div class="col-md-3 col-lg-3 rep'+ctr+'" ><label>Body Part: <small class="text-danger">*</small></label><select class="form-control select2 body_part" style="width: 100%;" ><option value="">Select Body Part</option><option value="1">Kub</option><option value="2">Left Chest</option><option value="3">Right Chest</option><option value="4">Cervical Spine</option><option value="5">Dorsal Spine</option><option value="6">Lumbar Spine</option><option value="7">Dorsal-Lumbar Spine</option><option value="8">Adenoids</option></select></div><div class="col-md-4 col-lg-4 rep'+ctr+'" ><label>View: <small class="text-danger">*</small></label><select class="form-control select2 body_view" name="view[]" data-placeholder="Select View" multiple="multiple" style="width: 100%;" ><option value="">Select View</option><option value="1">PA</option><option value="2">LATERAL</option><option value="3">AP OBLIQUE</option><option value="4">PA OBLIQUE</option></select></div><div class="col-md-1 col-lg-1 remove_report rep'+ctr+'" data-ctr="'+ctr+'"><i class="fa fa-minus-circle ml-20 mt-40" data-toggle="tooltip" data-original-title="Remove File"></i></div>');

                    $('.body_part').select2().trigger('change');
                    $('.body_view').select2().trigger('change');

                    ctr++;
                });

                $('body').on('click', '.remove_report', function(){

                    var ctrVar = $(this).data('ctr');

                    $('.rep'+ctrVar).remove();

                    ctr--;
                });

                $('.submit_report').on('click', function(e){

                    e.preventDefault();

                    swal({
                        title: "Assign report ?",
                        text: "Do you want to assign report now ?", 
                        icon: "info",
                        buttons: true,
                        dangerMode: true,
                    })
                    .then((willDelete) => {
                      if (willDelete) {
                            $('#send_report_modal').modal('show');
                            // swal("Poof! Your imaginary file has been deleted!", {
                            //   icon: "success",
                            // });
                      } else {
                        $('form').submit();
                            // swal("Your imaginary file is safe!");
                      }
                    });

                });
            });   
            // $(document).ready(function(){

            //     $('.dropzone row').bind('contentchanged', function(e) {

            //         e.preventDefault();
            //         // var input = $(this).files;

            //         console.log('test');

            //         // 'dropzone'
            //         // 'dz-filename'


            //     });

            //     // $('.dropzone').trigger('contentchanged');

            // });

            // var input = document.getElementById( 'dropFile' );
            // var infoArea = document.getElementById( 'upload-files' );

            // input.addEventListener( 'change', showFileName );

            function showFileName( event ) {

                // alert('text');

                // the change event gives us the input it occurred in
                var input = event.srcElement;

                // the input has an array of files in the `files` property, each one has a name that you can use. We're just using the name here.
                var fileName = input.files[0].name;

                // use fileName however fits your app best, i.e. add it into a div
                var fileNameTxt='File name: ' + fileName;

                // infoArea.textContent = 'File name: ' + fileName;

                infoArea.appendChild('<div class="col-md-4 col-lg-4" >'+fileNameTxt+'</div><div class="col-md-4 col-lg-4" ><select class="form-control select2" style="width: 100%;" ><option value="">Select Body Part</option><option value="1">Kub</option><option value="2">Left Chest</option><option value="3">Right Chest</option><option value="4">Cervical Spine</option><option value="5">Dorsal Spine</option><option value="6">Lumbar Spine</option><option value="7">Dorsal-Lumbar Spine</option><option value="8">Adenoids</option></select></div><div class="col-md-4 col-lg-4" ><select class="form-control select2" multiple="multiple" style="width: 100%;" ><option value="">Select View</option><option value="1">PA</option><option value="2">LATERAL</option><option value="3">AP OBLIQUE</option><option value="4">PA OBLIQUE</option></select></div>');
            }
        </script>

        <script>
            function sendReport(evt) {

                evt.preventDefault();

                $('#send_report_modal').modal('hide');

                swal("Selected reports are successfully assign to radiologist", {
                      icon: "success",
                });

                setTimeout(function(){
                    window.location.href="reports.php";
                }, 1000);
            }
        </script>
	
        <!-- Vendor JS -->
        {% include 'script.html' %}
	
    </body>
</html>
